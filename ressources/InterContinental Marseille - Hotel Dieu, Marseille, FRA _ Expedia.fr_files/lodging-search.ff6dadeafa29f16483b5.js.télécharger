(window.webpackJsonp=window.webpackJsonp||[]).push([[16],{yrpb:function(e,t,n){n.d(t,"a",(function(){return R}));var a=n("GiK3"),i=n("b3n2"),r=n("wlg7"),o=n("o5QM"),l=n("acEa"),d=n("29+M"),c=n("/5Tq"),u=function(){return(u=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};function s(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var a,i,r=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(a=r.next()).done;)o.push(a.value)}catch(l){i={error:l}}finally{try{a&&!a.done&&(n=r.return)&&n.call(r)}finally{if(i)throw i.error}}return o}function v(e){var t=Date.parse(e);if(isNaN(t)||!function(e){return new RegExp(/^(\d{4})-(\d{2})-(\d{2})$/).test(e)||new RegExp(/^\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\dZ$/).test(e)}(e))throw Error("Failed to convert "+e+" to a valid date.");var n,a=new Date(e);return n=a,new Date(n.getUTCFullYear(),n.getUTCMonth(),n.getUTCDate(),n.getUTCHours(),n.getUTCMinutes(),n.getUTCSeconds())}function p(e,t){var n=v(e),a=v(e);return a.setDate(n.getDate()+t),a}var f,m={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"DateFieldQuery"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"context"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ContextInput"}}},defaultValue:void 0,directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"propertyId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},defaultValue:void 0,directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"roomInput"}},type:{kind:"NonNullType",type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"RoomInput"}}}}},defaultValue:void 0,directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"dateRange"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"PropertyDateRangeInput"}}},defaultValue:void 0,directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:void 0,name:{kind:"Name",value:"propertyInfo"},arguments:[{kind:"Argument",name:{kind:"Name",value:"context"},value:{kind:"Variable",name:{kind:"Name",value:"context"}}},{kind:"Argument",name:{kind:"Name",value:"propertyId"},value:{kind:"Variable",name:{kind:"Name",value:"propertyId"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:void 0,name:{kind:"Name",value:"propertyCalendar"},arguments:[{kind:"Argument",name:{kind:"Name",value:"dateRange"},value:{kind:"Variable",name:{kind:"Name",value:"dateRange"}}},{kind:"Argument",name:{kind:"Name",value:"roomInput"},value:{kind:"Variable",name:{kind:"Name",value:"roomInput"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:void 0,name:{kind:"Name",value:"propertyCalendarRates"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:void 0,name:{kind:"Name",value:"date"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:void 0,name:{kind:"Name",value:"isoFormat"},arguments:[],directives:[],selectionSet:void 0}]}},{kind:"Field",alias:void 0,name:{kind:"Name",value:"displayPrice"},arguments:[],directives:[],selectionSet:void 0}]}},{kind:"Field",alias:void 0,name:{kind:"Name",value:"disclaimer"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:void 0,name:{kind:"Name",value:"value"},arguments:[],directives:[],selectionSet:void 0}]}}]}}]}}]}}],loc:{start:0,end:452,source:{body:"\n  query DateFieldQuery($context: ContextInput!, $propertyId: String!, $roomInput: [RoomInput!]!, $dateRange: PropertyDateRangeInput!) {\n    propertyInfo(context: $context, propertyId: $propertyId) {\n      propertyCalendar(dateRange: $dateRange, roomInput: $roomInput) {\n        propertyCalendarRates {\n          date {\n            isoFormat\n          }\n          displayPrice\n        }\n        disclaimer {\n          value\n        }\n      }\n    }\n  }\n",name:"GraphQL request",locationOffset:{line:1,column:1}}}};!function(e){e.SEARCH_FORM_RATE_CALENDAR_FETCH_ERROR="SEARCH_FORM_RATE_CALENDAR_FETCH_ERROR",e.SEARCH_FORM_RATE_CALENDAR_ERROR="SEARCH_FORM_RATE_CALENDAR_ERROR"}(f||(f={}));var y,k=function(e,t,n){var a,i,r,o,l=(a=new Date,new Date(a.getFullYear(),a.getMonth(),a.getDate())),d=p(t,150),c=(i=n(l,{raw:"yyyy-MM-dd"}),r=v(e).toString(),o=v(i).toString(),Math.floor((Date.parse(r)-Date.parse(o))/864e5));return{checkInDate:c<=90&&c>=0?l:p(e,-90),checkOutDate:d}},D=function(e,t,n,r,o){var v=s(function(e){var t=s(Object(a.useState)({}),2),n=t[0],i=t[1],r=s(Object(a.useState)(""),2),o=r[0],l=r[1];return[function(){e&&"function"==typeof e&&e().then((function(e){e&&"object"==typeof e&&e.datePickerContent&&e.disclaimer&&(i(e.datePickerContent),l(e.disclaimer))})).catch((function(){}))},n,o]}(e),3),p=v[0],y=v[1],D=v[2],g=s(function(){var e=s(Object(a.useState)({}),2),t=e[0],n=e[1],r=s(Object(a.useState)(""),2),o=r[0],v=r[1],p=Object(c.useBexApi)().context,y=Object(l.useLocalization)().formatDate,D=Object(i.a)().error,g=s(Object(d.a)(m,{ssr:!1}),2),R=g[0],b=g[1],C=b.data,h=b.error;Object(a.useEffect)((function(){if(h&&(v(""),n({}),D(f.SEARCH_FORM_RATE_CALENDAR_FETCH_ERROR)),C){var e=C.propertyInfo.propertyCalendar,t=e.propertyCalendarRates,a=e.disclaimer,i=function(e){var t={};return e.forEach((function(e){var n,a,i,r;(null===(n=e)||void 0===n?void 0:n.date)&&(null===(i=null===(a=e)||void 0===a?void 0:a.date)||void 0===i?void 0:i.isoFormat)&&(null===(r=e)||void 0===r?void 0:r.displayPrice)&&(t[e.date.isoFormat]={text:e.displayPrice,className:"",ariaLabel:""})})),t}(t);i&&(v(a.value),n(i))}}),[C,h,D]);return[function(e,t,n){var a;try{var i=k(t,n,y),r=i.checkInDate,o=i.checkOutDate,l={context:p,propertyId:e,dateRange:{checkInDate:{day:r.getDate(),month:r.getMonth()+1,year:null===(a=r)||void 0===a?void 0:a.getFullYear()},checkOutDate:{day:o.getDate(),month:o.getMonth()+1,year:o.getFullYear()}},roomInput:[{adults:2}]},d=u({},l||{});R({variables:d})}catch(c){D(f.SEARCH_FORM_RATE_CALENDAR_ERROR,c)}},t,o]}(),3),R=g[0],b=g[1],C=g[2];Object(a.useEffect)((function(){t?p():n&&r&&o&&R(o,n,r)}),[]);var h=function(){t?p():n&&r&&o&&R(o,n,r)};return t?[h,y,D]:[h,b,C]};!function(e){e.START="start",e.END="end"}(y||(y={}));var g=function(e){var t,n,i,d=e.analyticsCB,c=e.isDateless,v=e.startDate,p=e.endDate,f=e.onMountCB,m=e.buttonText,k=e.fetchDatePickerRates,g=e.dateFieldProps,R=e.propertyId,b=e.triggeredSelector,C=s(D(k,c,v,p,R),3),h=C[0],N=C[1],O=C[2],S=s(Object(a.useState)(!1),2),E=S[0],A=S[1],T=s(Object(a.useState)(!1),2),F=T[0],I=T[1],M=s(function(){var e=s(Object(o.useDialog)("datepicker-start"),3),t=e[1],n=e[2],i=s(Object(o.useDialog)("datepicker-end"),3),r=i[0],l=i[1],d=i[2];return[function(e,t){return t===y.END?Object(a.createElement)(d,null,e):Object(a.createElement)(n,null,e)},function(e,n){n&&(e===y.END?l.openDialog():t.openDialog())},function(e){e&&(r?l.closeDialog():t.closeDialog())}]}(),3),x=M[0],P=M[1],_=M[2],j=Object(l.useLocalization)(),w=j.getWeekData,L=j.formatDate;Object(a.useEffect)((function(){A(!0)}),[]);var V=function(e,t){return t&&"function"==typeof t?{startAnalytics:t(":ChangeDatesCheckIn","Open Date Picker"),endAnalytics:t(":ChangeDatesCheckOut","Open Date Picker"),datePickerAnalytics:{closeAnalytics:t(":ChangeDatesClose","Close Date Picker"),doneAnalytics:e?t(":DatepickerSearch","Search Date Picker"):t(":ChangeDatesDone","Apply Date Picker"),nextPageAnalytics:t(":NextMonthClick","Next Month Click"),previousPageAnalytics:t(":PreviousMonthClick","Previous Month Click")}}:{}}(c,d),B=u(u({},g),{routerLinkWrapper:function(e){return Object(a.createElement)(a.Fragment,null,e)},showDatePicker:F,startAnalytics:null===(t=V)||void 0===t?void 0:t.startAnalytics,endAnalytics:null===(n=V)||void 0===n?void 0:n.endAnalytics});E||(B.endPlaceholder=e.localDateFormat,B.startPlaceholder=e.localDateFormat);var H=parseInt(r.a[w().firstDay.toUpperCase()],10),$={analytics:null===(i=V)||void 0===i?void 0:i.datePickerAnalytics,buttonText:m,dateFieldProps:B,datePickerContent:N,daysBookableInAdvance:500,dialogWrapper:x,doubleMonths:!0,endDate:p,firstDayOfWeek:H,footerText:O,midnightBookingOffset:5,onDismissCB:function(e,t){_(e),t||I(!1)},onMountCB:f,onOpenCB:function(e,t){P(e,t),h(),I(!0)},onSubmitCB:function(t,n){var a=L(t,{raw:"yyyy-MM-dd"}),i=L(n,{raw:"yyyy-MM-dd"});v===a&&p===i||e.onChange({target:[{name:"startDate",value:L(t,{raw:"yyyy-MM-dd"})},{name:"endDate",value:L(n,{raw:"yyyy-MM-dd"})}]}),I(!1)},startDate:v,triggeredSelector:b};return Object(a.createElement)(r.b,u({},$))},R=function(e){var t,n,r=e.analyticsCB,o=e.endDate,l=e.fetchDatePickerRates,d=e.isDateless,c=e.isFormSubmitted,v=e.localDateFormat,p=e.localizedTextMap,f=e.onChange,m=e.propertyId,k=e.registerValidator,D=e.startDate,R=e.wrapperClasses,b=e.useCustomTrigger,C=e.triggeredSelector,h=Object(a.useRef)(null),N=Object(a.useRef)(null),O=s(function(e,t,n,i){var r=Object(a.useRef)(e),o=Object(a.useRef)(t);r.current=e,o.current=t;var l=function(e){return e&&"Invalid Date"!==e.toString()},d=n,c=function(e){var t,n=null===(t=e)||void 0===t?void 0:t.current;n&&"function"==typeof n.focus&&n.focus()};return[function(e,t,a,u){if(e===y.START){var s=r.current&&new Date(r.current);if(!l(s)&&(!n||t||n&&o.current))return{text:t&&d?i.invalidDateText:i.invalidStartDateText,focus:function(){return c(a)}}}if(e===y.END){var v=o.current&&new Date(o.current);if(!l(v)&&(!n||t||n&&r.current))return{text:t&&d?i.invalidDateText:i.invalidEndDateText,focus:function(){return c(u)}};s=r.current&&new Date(r.current);if(l(s)){if(v<s)return{text:i.invalidDateRange,focus:function(){return c(u)}};var p=new Date(s.getFullYear(),s.getMonth(),s.getDate()+28);if(p.setHours(0,0,0,0),v.setHours(0,0,0,0),v>p)return{text:i.invalidDateRangeLength,focus:function(){return c(u)}}}}return null}]}(D,o,d,p),1)[0];Object(a.useEffect)((function(){k((function(){return O(y.START,!0,h,N)})),k((function(){return O(y.END,!0,h,N)}))}),[k,O]);var S=O(y.START,c,h,N),E=O(y.END,c,h,N),A=Object(i.a)().warning;(S||E)&&A("SEARCH_FORM_DATE_RANGE_ERROR",S+" | "+E,"startDate="+D+" endDate="+o);var T={analyticsCB:r,buttonText:p.buttonText,endDate:o,fetchDatePickerRates:l,isDateless:d,localDateFormat:v,onChange:f,onMountCB:function(t,n){h=t,N=n,e.onMountCB(t,n)},startDate:D,triggeredSelector:C},F={dateFieldWrapperClasses:R,endId:"hotels-check-out",endInvalid:null===(t=E)||void 0===t?void 0:t.text,endLabel:p.endDateLabel,endName:"endDate",endPlaceholder:p.placeholder,onChange:f,startId:"hotels-check-in",startInvalid:null===(n=S)||void 0===n?void 0:n.text,startLabel:p.startDateLabel,startName:"startDate",startPlaceholder:p.placeholder,useCustomTrigger:b};return Object(a.createElement)(g,u({propertyId:m,dateFieldProps:F},T))}}}]);
//# sourceMappingURL=lodging-search.ff6dadeafa29f16483b5.js.map